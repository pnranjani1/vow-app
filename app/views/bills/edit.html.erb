
<div class="container">
 <div class="content">
   <div class="content-container" id="bill_body">      

    <div>
       <h4 class="heading-inline">Bills</h4>        
    </div><br>
      
    <script type="text/javascript">
       $(document).ready(function(){
         $("#bill_date").datepicker({ dateFormat: "dd/mm/yy" }).val();
         $("#lr_date").datepicker({ dateFormat: "dd/mm/yy" }).val();
       });  
    </script>
     
  <br/>
  <div class="row">
    <%= nested_form_for(@bill)  do |f| %>
       <% if @bill.errors.any? %>
        <div class="col-md-6">
         <div class="alert alert-danger">
           <% @bill.errors.full_messages.each do |error| %>
             <ul>
               <li><%= error %></li>
             </ul>
           <% end %>
         </div>
        </div>
       <% end %>
       <% if alert %>
         <div class="row">
           <div class="col-md-6">
             <div class="alert alert-danger"><%= alert %></div>
           </div>
         </div>
       <% end %>
    
       <div class="portlet">
           <div class="portlet-header">
              <h3><i class="fa fa-tags"></i> Bill Details</h3>
           </div> <!-- /.portlet-header -->

          
           <div class="portlet-content">
               <% if notice %>
                 <div class="alert alert-success"><%= notice %></div> 
               <% end %>
               <div class="row">
  
                &nbsp;&nbsp;<b style="color:red">*</b> <b>Indicates the mandatory fields</b><br/>
                <br/>               
                   <div class="col-sm-3">           
                     <strong>Invoice Number &nbsp;<b style="color:red">*</b></strong> 
                     <div id="name" class="input-group">    
                        <span class="input-group-addon"><i class="fa fa-sort-numeric-asc"></i></span>
                       <%= f.text_field :invoice_number, class: "form-control", :maxlength => 15, :required => true %> 
                       <%= f.hidden_field :invoice_format, :id => "check" %>
                      
                     </div>
                   </div> <!-- /.col -->
  
                   <div class="col-sm-3">           
                     <strong>Bill Date&nbsp;<b style="color:red">*</b></strong> 
                       <div id="name" class="input-group">               
                          <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                          <%= f.text_field :bill_date , :value => Date.today, class: "form-control", :id => "bill_date", :required => true %>
                       </div>
                   </div> <!-- /.col -->
                   
                   <%= f.hidden_field :pdf_format, :value => "Format1" %>
                   
                    <div class="col-sm-3">           
                       <strong>Customer&nbsp;<b style="color:red">*</b></strong> 
                        <div id="name" class="input-group">        
                          <span class="input-group-addon"><i class="fa fa-user"></i></span>
                          <%= f.collection_select :customer_id, @user_customers, :id, :name, {prompt: "Select Customer"}, {class: "form-control", :id => "drop-down", :required => true} %>
                        </div>
                    </div> <!-- /.col -->
               </div> <!-- row for 1st column ends here -->
                  <br/>
  

                  <!-- to add unregistered customers when creating bills -->
                  <div  style="display: none;" id="text-box"> 
                     <%= f.fields_for :unregistered_customers do |customer| %>  
                        <div class="row"> 
                            <%= customer.hidden_field :authuser_id, :value => current_authuser.id %>
     
                            <div class="col-sm-3 marggap">   
                               Customer Name&nbsp;&nbsp;<b style="color:red">*</b>
                                <div id="name" class="input-group">               
                                   <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                   <%= customer.text_field :customer_name, maxlength: 40,  class: "form-control" %>
                                </div>
                            </div> <!-- /.col -->
                          
                             <div class="col-sm-3 marggap">  
                              Mobile Number &nbsp;&nbsp;
                               <div id="email" class="input-group">          
                                  <span class="input-group-addon"><i class="glyphicon glyphicon-phone"></i></span>
                                 <%= customer.text_field :phone_number, :maxlength => 10, class: "form-control" %>
                               </div>
                            </div> <!-- /.col -->
                    
                            <div class="col-sm-3 marggap">  
                               Address &nbsp;&nbsp;<b style="color:red">*</b>
                               <div id="name" class="input-group">               
                                 <span class="input-group-addon"><i class="fa fa-map-marker"></i></span>
                                 <%= customer.text_field :address,  maxlength: 60, class: "form-control" %>
                               </div> 
                            </div><!-- /.col -->
       
                            <div class="col-sm-3 marggap">  
                               City<b style="color:red">*</b>
                               <div id="name" class="input-group">               
                                  <span class="input-group-addon"><i class="fa fa-map-marker"></i></span>
                                  <%= customer.text_field :city , maxlength: 15, class: "form-control" %>
                               </div>
                            </div> <!-- /.col -->
                        </div><!-- row ends here -->
 
                        <div class="row"> 
                            <div class="col-sm-3 marggap">  
                               State<b style="color:red">*</b>
                                 <div id="name" class="input-group">  
                                   <span class="input-group-addon"><i class="fa fa-map-marker"></i></span>
                                   <%= customer.collection_select :state, TinNumber.all, :state, :state, {:prompt => "Select State"}, {class: "form-control", :id => "state_list" }  %>
                                 </div>
                            </div> <!-- /.col -->
                     <% end %>
                   </div><!-- row ends here -->
                    
                  </div><!-- id=text box ends here-->
 
           </div> <!-- portlet content ends here -->
       </div><!-- portlet ends here -->
   <!-- bill detail ends here -->
   <!-- Item details starts -->
       <div class="portlet">
         
           <div class="portlet-header">
             <h3><i class="fa fa-gift"></i>Item Details</h3>
           </div> <!-- /.portlet-header -->

         <div class="portlet-content" id="line_items_list">
           <%= f.fields_for :line_items do |bill_product| %>
               
               <div class="row"> 
    
                  <div class="col-sm-2">           
                     <strong>Item&nbsp;<b style="color:red">*</b></strong> 
                     <div id="name" class="input-group">   
                       <span class="input-group-addon"><i class="fa fa-gift"></i></span>
                       <%= bill_product.collection_select :product_id, @user_products, :id, :product_name, 
{prompt: "Select Product"}, {class: "form-control", :required => true} %>
                     </div> 
                  </div> <!-- /.col -->
 
                  <div class="col-sm-2">           
                    <strong>Quantity&nbsp;<b style="color:red">*</b></strong> 
                    <div id="quantity_div" class="input-group">               
                       <span class="input-group-addon"><i class="fa fa-sort-numeric-asc"></i></span>
                      <%= bill_product.number_field :quantity , class: "form-control", :min => 1, :required => true %>
                    </div>
                  </div> <!-- /.col -->
           
                  <div class="col-sm-2">           
                     <strong>Unit Price&nbsp;<b style="color:red">*</b></strong> 
                     <div id="unit_price_div" class="input-group">               
                       <span class="input-group-addon"><i class="fa fa-money"></i></span>
                       <%= bill_product.text_field :unit_price, class: "form-control", :required => true %>
                     </div>
                  </div> <!-- /.col -->
               
                  <div class="col-sm-2">           
                    <strong>Service Tax %(Optional)&nbsp;</strong> 
                     <div id="unit_price_div" class="input-group"> 
                       <span class="input-group-addon"><i class="fa fa-money"></i></span>
                       <%= bill_product.text_field :service_tax_rate, class: "form-control" %>
                     </div>
                  </div> <!-- /.col -->
                  
                 <div id ='item_tax'>
                   <%= render partial: 'item_tax', locals: {bill_product: bill_product} %>
                 </div>
                                     
               </div><!-- row ends here --><br/>
           
               <div class="row">
                  <div class="col-sm-4">           
                    <strong>Item Description (Optional)&nbsp;</strong> 
                     <div id="name" class="input-group">   
                       <span class="input-group-addon"><i class="fa fa-gift"></i></span>
                       <%= bill_product.text_area :item_description, maxlength: 50, class: "form-control" %>
                     </div>
                  </div> <!-- /.col -->
                 
                  <div class="col-sm-1" style="margin-top:30px;">  
                    <%= bill_product.link_to_remove image_tag("remove_icon.png", width: 37, height: 37) %>
                  </div> <!-- /.col -->
               </div><!-- row ends here --><br/>
            <% end %><!-- nested_form ends here -->
           
           <%= f.link_to_add :line_items , title: "Add Products to the Bill" do %>
             <button class="btn btn-success" id='item_add'>
               <span class="glyphicon glyphicon-plus-sign"></span>
                Add Items
             </button>
           <% end %>
       </div> <!-- portlet content ends here -->
  </div><!-- portlet ends here -->

<!-- Item Details  ends here -->
  
    <!-- transport details starts -->
  <div class="portlet">

    <div class="portlet-header">
      <h3><i class="fa fa-share"></i> Transporter/Owner  Details</h3>
    </div> <!-- /.portlet-header -->

    <div class="portlet-content">
      <div class="row"> 
  
        <div class="col-sm-3">           
          <strong>Transporter Name</strong> 
          <div id="name" class="input-group">               
            <span class="input-group-addon"><i class="fa fa-user"></i></span>
            <%= f.text_field :transporter_name, maxlength: 45,  class: "form-control" %>
          </div>
        </div> <!-- /.col -->
            
        <div class="col-sm-3">           
           <strong>Vehicle Number</strong> 
           <div class="has-tooltip" data-toggle="tooltip" data-placement="left" title="Maximum limit is 12 digits">
             <div id="name" class="input-group">               
                <span class="input-group-addon"><i class="fa fa-sort-numeric-asc"></i></span>
                 <%= f.text_field :vechicle_number, :maxlength => 12, class: "form-control" %>
             </div>
           </div>
        </div> <!-- /.col -->
        
        <div class="col-sm-3">           
           <strong>GC/LR Number</strong> 
           <div class="has-tooltip" data-toggle="tooltip" data-placement="left" title="Maximum limit is 12 digits">
              <div id="name" class="input-group">               
                 <span class="input-group-addon"><i class="fa fa-sort-numeric-asc"></i></span>
                 <%= f.text_field :gc_lr_number, :maxlength => 12,  class: "form-control" %>
              </div>
           </div>
        </div> <!-- /.col -->

        <div class="col-sm-3">           
          <strong>LR Date</strong> 
           <div id="name" class="input-group">               
                 <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
              <%= f.text_field :lr_date, class: "form-control", :id => "lr_date" %>
           </div>
        </div> <!-- /.col -->
      </div> <!-- row ends here -->
    </div> <!-- portlet content ends here -->
  </div><!-- portlet ends here -->

<!-- Tranport Details ends Here -->  
  
  <!-- other information starts -->
  <div class="portlet">

      <div class="portlet-header">
        <h3><i class="fa fa-th"></i> Other Information and Discounts</h3>
      </div> <!-- /.portlet-header -->

      <div class="portlet-content">
         <div class="row"> 

            <div class="col-sm-3">           
               <strong>Name Other Charges (if any)</strong> 
               <div id="name" class="input-group">               
                  <span class="input-group-addon"><i class="fa fa-sort-numeric-asc"></i></span>
                  <%= f.collection_select :other_charges_information_id, OtherChargesInformation.all, :id, :other_charges,  {:prompt => "Select Type"} , {:class => "form-control"} %>
               </div>
            </div> <!-- /.col -->
            
            <div class="col-sm-3">           
               <strong>Other charges Amount</strong> 
               <div id="name" class="input-group">               
                  <span class="input-group-addon"><i class="fa fa-money"></i></span>
                 <%= f.number_field :other_charges, :min => 1, class: "form-control" %>
               </div>
            </div> <!-- /.col -->
           
            <div class="col-sm-3">           
              <strong>Discount <medium>(if any)</medium></strong> 
               <div id="name" class="input-group">               
                  <span class="input-group-addon"><i class="fa fa-money"></i></span>
                 <%= f.number_field :discount, :min => 1, class: "form-control" %>
               </div>
            </div> <!-- /.col -->
<%
=begin %>
            <div class="col-sm-3">           
               <strong>Tax Information&nbsp;<b style="color:red">*</b></strong> 
               <div id="name" class="input-group">  
                <span class="input-group-addon"><i class="fa fa-money"></i></span>
                  <%= f.collection_select :tax_id, Tax.all, :id, :tax ,{prompt: "Select Tax"}, {class: "form-control", :required => true} %>
               </div>
            </div> <!-- /.col -->
<%
=end %>
            <br/><br/><br/><br/>
  
            <div class="col-sm-9">           
               <strong>Other Information</strong> 
                 <div id="name" class="input-group">               
                   <%= f.text_area :other_information, :cols => 100, class: "form-control" %>
                 </div>
            </div> <!-- /.col -->
         </div> <!-- row ends here -->
      </div> <!-- portlet content ends here -->
  </div><!-- portlet ends here -->

      <div class="row">               
        <div class="col-md-2">
          <%= f.submit "Update Bill",  class: "btn btn-success" %>
        </div>
        
        <div class="col-md-2">
            <%= link_to "Cancel", new_bill_path,  class: "btn btn-success" %>
        </div>
    <% end %><!-- nested form ends here -->
   </div><!-- row ends here -->
  </div> <!-- /.content-container -->      
 </div> <!-- /.content -->
</div> <!-- /.container -->
  
  
  