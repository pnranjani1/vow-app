

 <div class="container">
 <div class="content">
 <div class="content-container">     
<div>
<h4 class="heading-inline">Bill Information </h4>   
  <% unless current_authuser.image_url.nil? %>
  <%= image_tag current_authuser.image_url, height: 50, width: 50 %>
  <% end %>
<!-- <%= gravatar_for current_authuser %> -->
</div>
<br>

<div class="row"> 
<div class="portlet" id="bill_body">
<div class="portlet-header">

<div class="row">

<div class="col-md-4">
<h3><i class="fa fa-group"></i>Bill of <%= @bill.customer.name  %></h3> 
</div>

<div class="col-md-4">
<h3><i class="fa fa-numeric"></i>Invoice Number&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @bill.invoice_number %></h3> 
</div>

<div class="col-md-4">
<h3><i class="fa fa-calender"></i>Bill Date&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @bill.bill_date.strftime("%b %d, %Y") %></h3> 
</div>  
</div><!-- row ends here-->
  <hr/>
  <div class="row">

<% if @bill.transporter_name != "" %>
<div class="col-md-3">
  <h3><i class="fa fa-group"></i>Transporter Name&nbsp;&nbsp;: &nbsp;&nbsp;&nbsp;<%= @bill.transporter_name  %></h3> 
</div>
<% else %>
<div class="col-md-3">
<h3><i class="fa fa-group"></i>Transporter Name&nbsp;&nbsp;: &nbsp;&nbsp;&nbsp; NA</h3> 
</div>
<% end %>
    
<% if @bill.gc_lr_number != "" %>
<div class="col-md-3">
<h3><i class="fa fa-numeric"></i>GC/LR number&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @bill.gc_lr_number %></h3> 
</div>
<% else %>
<div class="col-md-3">
<h3><i class="fa fa-numeric"></i>GC/LR number&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NA </h3> 
</div>
<% end %>

<div class="col-md-3">
<% if @bill.vechicle_number == "" %>
<h3><i class="fa fa-calender"></i>Vehicle Number&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NA</h3> 
  <% else %>
<h3><i class="fa fa-calender"></i>Vehicle Number&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @bill.vechicle_number %></h3> 
  <% end %>
</div>  
    
<div class="col-md-3">
  <% if @bill.lr_date == nil %>
<h3><i class="fa fa-calender"></i>LR Date&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NA</h3> 
  <% else %>
  <h3><i class="fa fa-calender"></i>LR Date&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @bill.lr_date.strftime("%d %b %Y") %></h3> 
  <% end %>
</div>  

</div><!-- row ends here-->
  
  
</div> <!-- /.portlet-header -->

<div class="portlet-content">
 <div id="user_notice" class='hide'>
  Esugam number has been generated successfully!
</div>
 
<div class="table-responsive">
<table id="user-signups" class="table table-striped table-bordered table-checkable"> 

  <% if @bill.esugam == nil && @bill.error_message != nil %>
     <% if @bill.error_message.length == 24 %>
        <h5 style="color:red">Error : <%= link_to "Download VAT Error",  path_to_image("vat-error.png"),  class: "listconttext", target: "blank"  %></h5>
     <% else %>
        <h5 style="color:red">Error : <%= @bill.error_message %></h5>
     <% end %>
  <% else %>
  <h4> Esugam Number : <%= @bill.esugam  %> </h4>
  <% end %>
    
<thead> 

<tr> 
<th>Product Name</th> 
<th>Quantity</th>  
<th>Unit Price</th>
<th>Total Price</th> 
<!-- <th>Delete</th>                     -->
</tr> 
</thead> 

<tbody> 
<% @bill.line_items.each do|line_item| %>
 <tr>                      
   <td><%= line_item.product.product_name  %></td> 
   <% qty = line_item.quantity %>
   <% if qty % 1 == 0.0 %>
   <td><%= qty.to_i %></td>
   <% else %>
   <td><%= qty %></td>
   <% end %>
   <td><%= number_with_delimiter(line_item.unit_price, :delimiter => ',') %></td> 
   <td width="28%"><%= number_with_delimiter(line_item.total_price.round(2), :delimiter => ',')  %></td>
 </tr>   
 <% end %>

<tr>
<td colspan="4">
<div class="comlin">
  
<table class="table table-bordered table-checkable">
    
<tr>
<td><strong>Bill Total</strong></td>
  <td><%= number_with_delimiter(@bill.total_bill_price.round(2), :delimiter => ',') %></td>
</tr>
 
<% if @bill.other_charges_information_id != nil %>
<tr>
  <td><strong><%= @bill.other_charges_information.other_charges %></strong></td>
  <td><%= number_with_delimiter(@bill.other_charges, :delimiter => ',') %></td>
</tr>
  <% end %>
  
<tr>
<% total = @bill.total_bill_price.to_f + @bill.other_charges.to_f %>    
  <td><strong><%= @bill.tax.tax_type %>  @ <%= @bill.tax.tax_rate %> % on <%=number_with_delimiter(total.round(2), :delimiter => ',') %></strong></td>
  <td><%=  number_with_delimiter((@bill.tax.tax_rate * 0.01*total).round(2), :delimiter => ',') %></td>
</tr>

<tr>
<td><strong>Grand Total</strong></td>
  <td><%= number_with_delimiter(@bill.grand_total.round(2), :delimiter => ',') %></td>
</tr>
   
</table>
  



</div> <!-- /.portlet-footer -->
    
</td>
</tr>

</tbody>
</table>

<div class="col-md-10">
<div class="col-md-2" align="left">
<%= link_to "Generate PDF", bill_path(@bill.id, format: "pdf"), class: "btn btn-success", target: "blank"  %>
</div>
 
 <% 
=begin %>
  <!-- Button trigger modal -->
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
  Select PDF format
</button>

  <%= content_for :pdf do %> 
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
       <form action="">
<input type="radio" name="pdf" value="1">Format 1<br>
<input type="radio" name="pdf" value="2">Format 2
         <input type="radio" name="pdf" value="3">Format 3
         <input type="radio" name="pdf" value="4">Format 4
         
         <input type="submit" value="Submit">
</form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

  <% end %> 
 <%  
=end %>
  
  
  <div id='esugam_div'>
    <%= render 'esugam_button' %> 
  </div>
  
  
  <div class="col-md-2">
    <%= link_to 'Continue Billing', new_bill_path,  class: 'btn btn-success' %>
 
  
<br/><br/>
  
</div> 
  
</div><!-- col-md-10 ends here -->
   
</div> <!-- /.table-responsive -->
</div> <!-- /.portlet-content -->
        
</div> <!-- /.portlet -->
</div> <!-- /.row -->
   
</div> <!-- content container ends here -->
</div> <!-- contemt ends here -->
</div> <!-- container ends here -->
  




